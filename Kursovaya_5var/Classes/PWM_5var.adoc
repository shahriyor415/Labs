:toc:
:toc-title: Оглавление

[.text-center]
МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ +
Федеральное государственное автономное образовательное учреждение высшего образования +
«Южно-Уральский государственный университет» +
(национальный исследовательский университет) +
Высшая школа электроники и компьютерных наук +
Кафедра «Информационно-измерительная техника»

[.text-center]

Полный листинг кода класса PWM

[.text-right]
Выполнил: +
студент группы КЭ-413 +
Хайдарзода Ш.Н.

[source, c]
#pragma once
#include "gpiocregisters.hpp"
#include "rccregisters.hpp"
#include "tim3registers.hpp"
#include "MainTask.hpp"
#include "Variable.hpp"
#include "LedTask.hpp"
#include "Led.hpp"
template <typename Timer> // Объявляем таймер из другого класса
class PWM
{
public:
  void SetDuty(uint16_t DutyCycle) // Создаем метод и передаем в него значение, рассчитанное в другом классе
  {
  if (DutyCycle < 1024)
  {
    Timer::CCR1::Write(DutyCycle); // Регулируется яркость первого светодиода
     Timer::CCR2::Write(0); // Четвертый светодиод не горит
        Timer::CCR3::Write(0); // Третий светодиод не горит
          Timer::CCR4::Write(0); // Второй светодиод не горит
  }
else  {
 Timer::CCR1::Write(1024); // Первый свтодиод горит на максимальной яркости
     Timer::CCR2::Write(0); // Четвертый светодиод не горит
        Timer::CCR3::Write(0); // Третий светодиод не горит
          Timer::CCR4::Write(0); // Второй светодиод не горит
 if (DutyCycle < 2048)
  {
    Timer::CCR4::Write(DutyCycle-1024); // Регулируется яркость второго светодиода
    Timer::CCR2::Write(0); // Четвертый светодиод не горит
        Timer::CCR3::Write(0); // Третий светодиод не горит
          Timer::CCR1::Write(1024); // Первый светодиод горит на максимальной яркости
  }
    else
    {
      Timer::CCR4::Write(1024); // Второй светодиод горит на максимальной яркости
      Timer::CCR2::Write(0); // Четвертый светодиод не горит
      Timer::CCR3::Write(0); // Третий светодиод не горит
      Timer::CCR1::Write(1024); // Первый светодиод горит на максимальной яркости
if (DutyCycle < 3072)
{
Timer::CCR3::Write(DutyCycle-2048); // Регулируется яркость третьего светодиода
Timer::CCR2::Write(0); // Четвертый светодиод не горит
Timer::CCR1::Write(1024); // Регулируется яркость первого светодиода
Timer::CCR4::Write(1024); // Регулируется яркость второго светодиода
}
else  {
Timer::CCR3::Write(1024); // Третий светодиод горит на максимальной яркости
Timer::CCR2::Write(0); // Четвертый светодиод не горит
Timer::CCR1::Write(1024); // Первый светодиод горит на максимальной яркости
Timer::CCR4::Write(1024); // Второй светодиод горит на максимальной яркости
if (DutyCycle < 4096)
{
Timer::CCR2::Write(DutyCycle-3072); // Регулируется яркость четвертого светодиода
Timer::CCR1::Write(1024); // Первый светодиод горит на максимальной яркости
Timer::CCR4::Write(1024); // Второй светодиод горит на максимальной яркости
Timer::CCR3::Write(1024); // Третий светодиод горит на максимальной яркости
}
else {
Timer::CCR2::Write(1024); // Четвертый светодиод горит на максимальной яркости
Timer::CCR1::Write(1024); // Первый светодиод горит на максимальной яркости
Timer::CCR4::Write(1024); // Второй светодиод горит на максимальной яркости
Timer::CCR3::Write(1024); // Третий светодиод горит на максимальной яркости
}
}
}
}
}
};
